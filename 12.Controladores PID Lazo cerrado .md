# Dise帽o y Sintonizaci贸n de Controladores PID en Lazo Cerrado

En el dominio de la ingenier铆a mecatr贸nica y los sistemas de control, la manipulaci贸n precisa de variables de proceso es indispensable para el funcionamiento 贸ptimo de maquinaria y sistemas complejos. Los controladores Proporcionales, Integrales y Derivativos (PID) representan la arquitectura de control m谩s prevalente y efectiva en la industria, debido a su simplicidad conceptual y su robustez inherente. No obstante, la consecuci贸n de un rendimiento 贸ptimo de estos controladores depende cr铆ticamente de una sintonizaci贸n precisa de sus par谩metros. En este contexto, los m茅todos de sintonizaci贸n en lazo cerrado adquieren particular relevancia, ya que permiten la caracterizaci贸n din谩mica de un sistema y el ajuste del controlador mientras este opera bajo condiciones normales de proceso. 

Este documento profundizar谩 en las metodolog铆as fundamentales para el dise帽o y sintonizaci贸n de controladores PID en lazo cerrado, abordando t茅cnicas establecidas como el M茅todo de Ziegler & Nichols y el M茅todo del Rel茅. Asimismo, se examinar谩n consideraciones operativas cr铆ticas, incluyendo el fen贸meno de acumulaci贸n integral (*wind-up*) y las estrategias anti-*wind-up* asociadas, elementos esenciales para la implementaci贸n exitosa y el desempe帽o fiable de los sistemas de control en aplicaciones de ingenier铆a.

## 1. Fundamentos del Lazo Cerrado en la Sintonizaci贸n de Controladores

El control en lazo cerrado, tambi茅n conocido como control por realimentaci贸n, constituye un paradigma esencial en la automatizaci贸n y la rob贸tica. En esta configuraci贸n, la se帽al de salida de un sistema se compara con una se帽al de referencia o *setpoint*, y la desviaci贸n resultante (error) se emplea para generar una acci贸n de control que busca minimizar dicho error y mantener la variable de salida pr贸xima al valor deseado.

> **Lazo Cerrado (Realimentado):** Arquitectura de control en la cual la se帽al de salida medida de un sistema es continuamente comparada con una se帽al de referencia deseada. La diferencia entre ambas, denominada error, es utilizada por el controlador para calcular y aplicar una acci贸n correctiva que busca reducir el error y mantener la variable controlada en el valor especificado.

La sintonizaci贸n de controladores PID en lazo cerrado se fundamenta en la capacidad de inferir los par谩metros din谩micos de la planta (el proceso a controlar) a partir de su respuesta mientras se encuentra operando dentro de su configuraci贸n de lazo cerrado. Esta aproximaci贸n es particularmente ventajosa en ambientes industriales donde la interrupci贸n del proceso para realizar pruebas en lazo abierto no es factible o implica costos operativos elevados. Las pruebas en lazo cerrado permiten caracterizar la din谩mica del sistema *in situ*, bajo sus condiciones de carga y operaci贸n normales, lo que a menudo conduce a una sintonizaci贸n m谩s representativa y eficaz. A partir de los datos recolectados durante estas pruebas, se procede a la determinaci贸n y ajuste iterativo de las ganancias Proporcional ($K_p$), Integral ($T_i$ o $K_i$) y Derivativa ($T_d$ o $K_d$) del controlador PID, con el objetivo primordial de optimizar m茅tricas de desempe帽o como el error en estado estacionario, el tiempo de respuesta (velocidad con la que el sistema alcanza el setpoint), la amortiguaci贸n de las oscilaciones y la robustez frente a perturbaciones.

## 2. Metodolog铆as de Sintonizaci贸n en Lazo Cerrado

La determinaci贸n de los valores 贸ptimos de las ganancias PID es un proceso iterativo y crucial. Existen diversas metodolog铆as para su consecuci贸n en lazo cerrado; entre las m谩s reconocidas por su aplicaci贸n pr谩ctica y su fundamentaci贸n te贸rica se encuentran el M茅todo de Ziegler & Nichols (espec铆ficamente la variante del "ciclo 煤ltimo") y el M茅todo del Rel茅.

### 2.1. M茅todo de Ziegler & Nichols (Ciclo ltimo)

El m茅todo de Ziegler & Nichols, en su variante de "ciclo 煤ltimo" (tambi茅n conocido como m茅todo de "oscilaci贸n"), es una t茅cnica emp铆rica de sintonizaci贸n de controladores PID en lazo cerrado. Su simplicidad operativa ha consolidado su popularidad, aunque requiere la inducci贸n de un estado de oscilaci贸n sostenida en el sistema, lo cual puede implicar una cierta perturbaci贸n del proceso.

El procedimiento para la aplicaci贸n de este m茅todo se articula en los siguientes pasos:
1.  **Configuraci贸n Inicial (Solo Proporcional):** Inicialmente, se anulan las acciones integral ($K_i$ o $T_i$) y derivativa ($K_d$ o $T_d$) del controlador, estableciendo sus ganancias a cero. De esta forma, el controlador opera exclusivamente en modo Proporcional (P-control).
2.  **Inducci贸n de Oscilaci贸n Sostenida (Ganancia ltima $K_u$):** La ganancia proporcional ($K_p$) del controlador se incrementa gradualmente desde un valor bajo. Este aumento debe realizarse de manera controlada, monitoreando continuamente la respuesta de la variable de salida del sistema. El objetivo es identificar el valor cr铆tico de $K_p$ que provoca que la salida del sistema comience a oscilar de forma sostenida y marginalmente estable, es decir, con una amplitud constante y sin amortiguaci贸n ni crecimiento. Este valor de ganancia se denomina **ganancia 煤ltima** ($K_u$).
3.  **Medici贸n del Periodo ltimo ($P_u$):** Una vez que el sistema se encuentra en este estado de oscilaci贸n marginalmente estable, se mide el tiempo transcurrido para completar un ciclo completo de la oscilaci贸n. Este valor se designa como **periodo 煤ltimo** ($P_u$).

Con los valores de $K_u$ y $P_u$ obtenidos experimentalmente (o anal铆ticamente), se emplean las f贸rmulas de sintonizaci贸n predefinidas por Ziegler & Nichols para determinar los par谩metros finales del controlador P, PI o PID. Estas f贸rmulas est谩n tabuladas y se basan en un compromiso entre tiempo de subida r谩pido y un sobreimpulso aceptable (generalmente alrededor del 25% para un controlador PID bien sintonizado con este m茅todo).

Las ecuaciones de sintonizaci贸n de Ziegler-Nichols son:

Para un controlador Proporcional (P):
$$K_p = 0.5 \times K_u$$

Para un controlador Proporcional-Integral (PI):
$$K_p = 0.45 \times K_u$$
$$T_i = \frac{P_u}{1.2}$$

Para un controlador Proporcional-Integral-Derivativo (PID):
$$K_p = 0.6 \times K_u$$
$$T_i = \frac{P_u}{2}$$
$$T_d = \frac{P_u}{8}$$

Con los valores de $K_u$ y $P_u$ obtenidos experimentalmente (o anal铆ticamente, como se ver谩 en el ejemplo), se emplean las f贸rmulas de sintonizaci贸n predefinidas por Ziegler & Nichols para determinar los par谩metros finales del controlador P, PI o PID. Estas f贸rmulas est谩n tabuladas y se basan en un compromiso entre tiempo de subida r谩pido y un sobreimpulso aceptable (generalmente alrededor del 25% para un controlador PID bien sintonizado con este m茅todo).

### 2.1.1. Soluci贸n Anal铆tica (Ejemplo Extendido)

Para ilustrar la aplicaci贸n de este m茅todo de forma anal铆tica, consideremos un sistema con la funci贸n de transferencia en lazo abierto dada por :

$$G(s) = \frac{1}{s^{3}+6s^{2}+11s+6}$$

Para aplicar el m茅todo de Ziegler & Nichols (ciclo 煤ltimo), se asume un controlador puramente proporcional $C(s) = K_p$. La funci贸n de transferencia en lazo cerrado $G_o(s)$ (considerando una realimentaci贸n unitaria) se define como:

$$G_o(s) = \frac{C(s)G(s)}{1 + C(s)G(s)} = \frac{K_p \cdot \frac{1}{s^{3}+6s^{2}+11s+6}}{1 + K_p \cdot \frac{1}{s^{3}+6s^{2}+11s+6}}$$

Simplificando el denominador, que es el polinomio caracter铆stico de lazo cerrado:

$$s^{3}+6s^{2}+11s+6+K_{p} = 0$$

Para que el sistema oscile de manera sostenida (marginalmente estable), los polos del sistema en lazo cerrado deben ubicarse sobre el eje imaginario del plano complejo. Esto implica que la parte real de dichos polos debe ser cero. Podemos investigar esta condici贸n sustituyendo $s = j\omega$ en el polinomio caracter铆stico, donde $\omega$ representa la frecuencia de la oscilaci贸n:

$$(j\omega)^{3}+6(j\omega)^{2}+11(j\omega)+6+K_{p} = 0$$

Recordando que $j^2 = -1$ y $j^3 = -j$:
$$-j\omega^3 - 6\omega^2 + j11\omega + 6 + K_p = 0$$

Ahora, agrupamos los t茅rminos reales y los t茅rminos imaginarios de la ecuaci贸n :

$$(6+K_p - 6\omega^2) + j(11\omega - \omega^3) = 0$$

Para que esta igualdad sea v谩lida, tanto la parte real como la parte imaginaria de la expresi贸n deben ser nulas.
**Resolviendo para la Parte Imaginaria:**
$$11\omega - \omega^3 = 0$$
Factorizamos $\omega$:
$$\omega(11 - \omega^2) = 0$$
Esta ecuaci贸n tiene tres soluciones: $\omega = 0$, $\omega = \sqrt{11}$, y $\omega = -\sqrt{11}$. La soluci贸n $\omega = 0$ corresponde al estado estacionario y no a una oscilaci贸n. Las soluciones no triviales para la frecuencia de oscilaci贸n son $\omega_u = \sqrt{11}$ rad/s. Este valor representa la **frecuencia 煤ltima de oscilaci贸n** ($\omega_u$).

**Resolviendo para la Parte Real:**
$$6+K_p - 6\omega^2 = 0$$
Sustituimos el valor de $\omega^2 = 11$ (derivado de $\omega_u = \sqrt{11}$):
$$6+K_p - 6(11) = 0$$
$$6+K_p - 66 = 0$$
$$K_p - 60 = 0$$
$$K_p = 60$$

Este valor de $K_p$ es la **ganancia 煤ltima** ($K_u = 60$). Es la ganancia proporcional que lleva al sistema al borde de la estabilidad, resultando en oscilaciones sostenidas.

Con la frecuencia 煤ltima de oscilaci贸n $\omega_u = \sqrt{11}$ rad/s, el **periodo 煤ltimo** ($P_u$) se calcula como:

$$P_u = \frac{2\pi}{\omega_u} = \frac{2\pi}{\sqrt{11}} \approx 1.894 \text{ segundos}$$

Finalmente, se utilizan los valores de $K_u = 60$ y $P_u \approx 1.894$ segundos en la Tabla 1, la cual resume los coeficientes de sintonizaci贸n de Ziegler & Nichols para diferentes tipos de controladores:

| Tipo | $K_p$       | $T_i$           | $T_d$           |
|------|-------------|-----------------|-----------------|
| P    | $0.5K_u$    | ---             | ---             |
| PI   | $0.45K_u$   | $\frac{P_u}{1.2}$ | ---             |
| PID  | $0.6K_u$    | $\frac{P_u}{2}$   | $\frac{P_u}{8}$   |
Tabla 1. Coeficientes de sintonizaci贸n de Ziegler & Nichols.

Para un controlador **PID**, los par谩metros calculados son:
* $K_p = 0.6 \times K_u = 0.6 \times 60 = 36$
* $T_i = \frac{P_u}{2} = \frac{1.894}{2} = 0.947$ segundos
* $T_d = \frac{P_u}{8} = \frac{1.894}{8} = 0.23675$ segundos

Por lo tanto, los par谩metros para el controlador PID, sintonizado mediante el m茅todo de Ziegler & Nichols (ciclo 煤ltimo), son: $K_p = 36$, $T_i = 0.947$ s, y $T_d = 0.23675$ s. Estos valores proporcionan una base s贸lida para la implementaci贸n del controlador, que podr铆a requerir un ajuste fino posterior en el sistema real.

---

### 2.2. M茅todo del Rel茅 (Autosintonizaci贸n)

El M茅todo del Rel茅, introducido por K.J. str枚m y T. H盲gglund en 1984, es una t茅cnica de sintonizaci贸n de controladores m谩s sofisticada que el m茅todo de Ziegler & Nichols en lazo cerrado. Su principal ventaja radica en la capacidad de inducir oscilaciones sostenidas en el sistema de manera controlada, evitando la necesidad de llevar la ganancia proporcional a valores excesivamente altos o de provocar grandes perturbaciones en el proceso, lo cual puede ser riesgoso en aplicaciones industriales. Este m茅todo es a menudo la base para funciones de "autosintonizaci贸n" en controladores industriales modernos.

#### 2.2.1. Metodolog铆a del Rel茅

La implementaci贸n del m茅todo del Rel茅 implica los siguientes pasos fundamentales:

1.  **Preparaci贸n del Sistema:** El sistema se configura en lazo cerrado, pero en lugar de un controlador PID sintonizado, se introduce un rel茅 como elemento de control. Es recomendable medir el tiempo estacionario del sistema en lazo abierto antes de la prueba, para tener una referencia del comportamiento intr铆nseco del sistema.
2.  **Sustituci贸n por Rel茅 con Hist茅resis:** El lazo de control se cierra utilizando un rel茅 (un elemento no lineal con dos estados discretos, e.g., ON/OFF) que incorpora una caracter铆stica de hist茅resis. La hist茅resis es crucial; introduce una "zona muerta" o un diferencial en los puntos de conmutaci贸n del rel茅, lo que previene oscilaciones de alta frecuencia (*chattering*) y asegura una oscilaci贸n sostenida m谩s limpia en la salida de la planta. El rel茅 conmuta su salida ($u(t)$) entre dos valores (por ejemplo, $+d$ y $-d$) en funci贸n de si la se帽al de error ($e(t)$) cruza un umbral con cierta hist茅resis ($\epsilon$).
3.  **Inducci贸n y Captura de la Oscilaci贸n L铆mite:** Al activar el rel茅 con hist茅resis, el sistema entrar谩 en un ciclo de oscilaci贸n sostenida, tambi茅n conocido como "ciclo l铆mite". Se debe registrar y analizar la respuesta de la salida del sistema ($y(t)$) durante esta fase de oscilaci贸n.
4.  **Extracci贸n de Par谩metros de Oscilaci贸n:** De la oscilaci贸n sostenida de la salida del sistema, se miden dos par谩metros clave: el **periodo 煤ltimo ($P_u$)** y la **amplitud del ciclo 煤ltimo ($A_u$)**. El periodo 煤ltimo es el tiempo que tarda una oscilaci贸n completa, y la amplitud del ciclo 煤ltimo es la mitad de la diferencia entre el valor m谩ximo y m铆nimo de la oscilaci贸n de la salida de la planta.
5.  **C谩lculo de la Ganancia Cr铆tica Equivalente ($K_c$):** La ganancia cr铆tica equivalente ($K_c$) se determina a partir de la amplitud de la se帽al de salida del rel茅 ($d$), la amplitud de la oscilaci贸n de la planta ($A_u$), y la hist茅resis del rel茅 ($\epsilon$). La f贸rmula que relaciona estos par谩metros se deriva del an谩lisis de funciones de descripci贸n (DF - Describing Function) para elementos no lineales:

    $$K_{c}=\frac{4d}{\pi\sqrt{A_{u}^{2}-\epsilon^{2}}}$$

    Es fundamental que durante la prueba, se logre un desfase de $180^\circ$ entre la se帽al del rel茅 y la fundamental de la oscilaci贸n de la salida de la planta para que esta f贸rmula sea v谩lida.
6.  **Determinaci贸n de la Ganancia Est谩tica (opcional):** Adicionalmente a la ganancia cr铆tica, es relevante estimar la ganancia est谩tica del sistema, la cual puede ser inferida a partir del comportamiento en lazo abierto o del ensayo con el rel茅.

A partir de los valores obtenidos de $P_u$ y $K_c$, se utilizan ecuaciones de sintonizaci贸n espec铆ficas, a menudo adaptadas de las reglas de Ziegler & Nichols o de otras metodolog铆as de desempe帽o. Para la sintonizaci贸n de un controlador PI con el m茅todo del Rel茅, buscando un sobreimpulso m谩ximo inferior al 10%, se pueden emplear las siguientes f贸rmulas, seg煤n str枚m y H盲gglund:

| Controlador | $K_p$                                                        | $T_i$                                                        |
|-------------|--------------------------------------------------------------|--------------------------------------------------------------|
| PI          | $\frac{5K_c}{6}(\frac{12+KK_c}{15+14KK_c})$ | $\frac{P_u}{5}(1+\frac{4}{15}KK_c)$ |
Tabla 2. Ecuaciones para sintonizaci贸n PI con m茅todo de Rel茅 (adaptadas para desempe帽o).

---

### 2.2.2. Diagrama de Bloques y Respuesta T铆pica del M茅todo de Rel茅

Para una comprensi贸n m谩s profunda del mecanismo del m茅todo del rel茅, es instructivo visualizar su representaci贸n en diagrama de bloques y analizar la respuesta temporal caracter铆stica del sistema durante la prueba.

**Ejemplo 4:** El siguiente diagrama de bloques ilustra la topolog铆a de un sistema de control donde se ha implementado un rel茅 para la prueba de sintonizaci贸n.

![Diagrama de Bloques del M茅todo de Rel茅](http://googleusercontent.com/ontology/media/images/c234b071_2c52_4f1e_a696_9f50f28a7e04)
Figura 2. Diagrama de bloques de un sistema con controlador de rel茅.

En este esquema, la se帽al de error ($Error$) es la entrada al bloque del rel茅, cuya salida ($Control$) constituye la se帽al de control aplicada a la planta ($Proceso$). El rel茅, con su caracter铆stica no lineal de hist茅resis, alterna su salida entre dos valores discretos en funci贸n del cruce del error por los umbrales de conmutaci贸n. Esta acci贸n conmutada induce una oscilaci贸n en la variable de salida del proceso, la cual es esencial para la identificaci贸n de los par谩metros.

La respuesta temporal caracter铆stica del sistema a una prueba con rel茅 se distingue por una oscilaci贸n sostenida (ciclo l铆mite) en la variable de salida de la planta (e.g., temperatura del l铆quido), mientras que la se帽al de control generada por el rel茅 exhibe conmutaciones discretas entre sus dos estados.

**Ejemplo 5:** A continuaci贸n se presentan las gr谩ficas de la salida de temperatura del l铆quido y la se帽al de salida del rel茅 (representando la apertura de una v谩lvula, por ejemplo) obtenidas durante una prueba real con el m茅todo de rel茅.

![Salida del Rel茅 y Temperatura del L铆quido](http://googleusercontent.com/ontology/media/images/223b9d62_0d44_40d4_b7b6_81a63c631e84)
Figura 3. Salida de la temperatura del l铆quido y salida del rel茅 durante la prueba.

Como se puede observar en la Figura 3, la temperatura del l铆quido (gr谩fica superior) oscila de manera cuasi-sinusoidal alrededor del punto de referencia debido a la acci贸n conmutada del rel茅. De esta gr谩fica, se pueden identificar claramente el periodo de la oscilaci贸n ($t$) y la amplitud ($a$) de la misma. La gr谩fica inferior muestra la se帽al de control generada por el rel茅, con sus dos estados discretos, y la amplitud ($d$) de esta se帽al de control. Este comportamiento oscilatorio es la base para la extracci贸n de los par谩metros $P_u$, $A_u$ y la ganancia cr铆tica $K_c$, que posteriormente se utilizan en las f贸rmulas de sintonizaci贸n.

---

## 3. Fen贸meno *Wind-up* y Estrategias Anti Wind-up

En controladores que incorporan una acci贸n integral (particularmente en controladores PI y PID), un problema operativo com煤n y de importancia cr铆tica es el fen贸meno conocido como *wind-up* o "acumulaci贸n integral". Este fen贸meno se manifiesta cuando el actuador del sistema alcanza sus l铆mites de saturaci贸n, es decir, cuando su salida f铆sica alcanza su valor m谩ximo o m铆nimo posible.

> **Fen贸meno *Wind-up* (Acumulaci贸n Integral):** Es la acumulaci贸n excesiva y no deseada del t茅rmino integral en un controlador PID. Ocurre cuando la se帽al de control calculada por el controlador excede los l铆mites f铆sicos de operaci贸n del actuador, lo que lleva a la saturaci贸n de este 煤ltimo. El integrador, al continuar sumando el error, acumula un valor desproporcionadamente grande. Como consecuencia, al cambiar la referencia o al salir de la saturaci贸n, el controlador tarda un tiempo prolongado en restablecer su operaci贸n normal, generando sobreimpulsos considerables, oscilaciones y una respuesta transitoria degradada.

La mec谩nica del *wind-up* se puede explicar de la siguiente manera: si la variable de proceso est谩 lejos del punto de ajuste y el actuador ya est谩 operando a su m谩xima capacidad (saturado), el error persistir谩 y la acci贸n integral seguir谩 increment谩ndose indefinidamente, ya que el integrador contin煤a sumando el error remanente. Esto resulta en un valor integral extremadamente grande, mucho mayor que el necesario para llevar la salida al *setpoint*. Cuando el error finalmente disminuye o cambia de signo (por ejemplo, porque la salida del proceso se acerca o sobrepasa el *setpoint*), el t茅rmino integral sobredimensionado debe "descargarse" (o integrarse en la direcci贸n opuesta) antes de que la se帽al de control del controlador pueda volver a operar dentro de los l铆mites del actuador y de manera efectiva. Este proceso de descarga introduce un retardo significativo, provoca grandes sobreimpulsos y puede generar un comportamiento inestable o ineficiente del sistema.

**Ejemplo 6:** La siguiente figura ilustra el impacto del fen贸meno *wind-up* en la respuesta de un sistema real.

![Fen贸meno Wind-up](http://googleusercontent.com/ontology/media/images/154c1a84_832d_494c_a62f_2b7ec992b861)
Figura 4. Comportamiento de un sistema afectado por el fen贸meno wind-up.

En la Figura 4, la gr谩fica superior muestra la se帽al de referencia ($y_{sp}$) y la salida del sistema ($y$). Se observa que cuando la referencia aumenta r谩pidamente, la se帽al de salida del actuador ($u$, gr谩fica central) alcanza su l铆mite de saturaci贸n y se mantiene en un valor constante. Durante este per铆odo de saturaci贸n del actuador, el t茅rmino integral ($I$, gr谩fica inferior) contin煤a creciendo de manera incontrolada, acumulando un error integral significativo. Una vez que la salida del sistema ($y$) finalmente se acerca a la referencia, el actuador deja la saturaci贸n, pero el t茅rmino integral sobreacumulado obliga a la salida a sobrepasar el *setpoint* y exhibir oscilaciones prolongadas o un tiempo de asentamiento excesivo. Este comportamiento es claramente indeseable en la mayor铆a de las aplicaciones de control.

Para mitigar los efectos perjudiciales del *wind-up*, se han desarrollado diversas estrategias "anti wind-up", las cuales modifican el comportamiento del integrador cuando el actuador se satura.

### 3.1. Anti Wind-up por Saturaci贸n de la Acci贸n Integral (Clamping)

Una de las estrategias anti-*wind-up* m谩s directas y de f谩cil implementaci贸n es la saturaci贸n de la acci贸n integral, tambi茅n conocida como *integrator clamping* o limitaci贸n del integrador. Este m茅todo consiste en detener la integraci贸n del error cuando la se帽al de salida calculada por el controlador (antes de ser aplicada al actuador) excede los l铆mites de saturaci贸n del actuador.

**Ejemplo 7:** El diagrama de bloques para la estrategia anti *wind-up* por saturaci贸n de la acci贸n integral se presenta a continuaci贸n:

![Anti Wind-up por Saturaci贸n](http://googleusercontent.com/ontology/media/images/ecfc3508_4c21_4250_b9ec_19446d32847a)
Figura 5. Diagrama de bloques de un controlador PID con anti wind-up por saturaci贸n de la acci贸n integral.

En este esquema, se implementa una l贸gica condicional: si la se帽al de control que se intenta enviar al actuador es mayor que su l铆mite m谩ximo o menor que su l铆mite m铆nimo, la acci贸n integral se "congela" (no se permite que el integrador siga sumando error) o se limita a un valor que no provoque una saturaci贸n mayor. Al detener la acumulaci贸n integral durante la saturaci贸n del actuador, se previene que el t茅rmino integral alcance valores excesivamente grandes, lo que permite una recuperaci贸n m谩s r谩pida y un mejor comportamiento transitorio del sistema al salir de la saturaci贸n. Sin embargo, los tiempos de respuesta del sistema a煤n pueden verse afectados y se pueden producir pulsos no deseados.

### 3.2. Anti Wind-up por Integraci贸n Condicional

La integraci贸n condicional es una estrategia efectiva que refina el concepto de la saturaci贸n del integrador. En este m茅todo, la acci贸n integral solo se activa (es decir, el t茅rmino integral solo se acumula) bajo ciertas condiciones predefinidas, t铆picamente cuando la se帽al de error est谩 dentro de un rango espec铆fico o, m谩s com煤nmente, cuando el actuador *no* est谩 operando en saturaci贸n.

**Ejemplo 8:** El diagrama de bloques para la estrategia anti *wind-up* por integraci贸n condicional se muestra a continuaci贸n:

![Anti Wind-up por Integraci贸n Condicional](http://googleusercontent.com/ontology/media/images/bf7e31d3_b713_4a50_b51b_1001a75094ef)
Figura 6. Diagrama de bloques de un controlador PID con anti wind-up por integraci贸n condicional.

Esta soluci贸n busca mejorar el tiempo de respuesta del sistema y evitar la generaci贸n de "pulsos" no deseados o comportamientos err谩ticos que podr铆an surgir de una suspensi贸n abrupta de la acci贸n integral. Al condicionar cu谩ndo se integra el error, se previene la acumulaci贸n excesiva cuando el actuador est谩 saturado o cuando el error es demasiado grande, resultando en una respuesta m谩s suave, predecible y una mejor capacidad de seguimiento de la referencia. El integrador solo se activa cuando su contribuci贸n puede ser efectivamente procesada por el actuador.

### 3.3. Anti Wind-up por Rec谩lculo y Seguimiento (Tracking Anti-Wind-up)

El m茅todo de rec谩lculo y seguimiento, tambi茅n conocido como *tracking anti-wind-up* o anti-*wind-up* con realimentaci贸n del actuador, es una estrategia anti-*wind-up* m谩s sofisticada y ampliamente utilizada en sistemas de control avanzados. Implica la realimentaci贸n de la salida *real* del actuador (la se帽al saturada) al integrador.

**Ejemplo 9:** El diagrama de bloques para la estrategia anti *wind-up* por rec谩lculo y seguimiento se muestra a continuaci贸n:

![Anti Wind-up por Rec谩lculo y Seguimiento](http://googleusercontent.com/ontology/media/images/5f97d5a5_9436_4020_9185_f37f37dd2b44)
Figura 7. Diagrama de bloques de un controlador PID con anti wind-up por rec谩lculo y seguimiento.

En este enfoque, la se帽al de control que realmente sale del controlador es comparada con la se帽al que el controlador *intenta* enviar al actuador. La diferencia entre estas dos se帽ales (que es no nula solo cuando hay saturaci贸n) es realimentada al integrador a trav茅s de una ganancia, $1/T_t$, donde $T_t$ es el "tiempo de seguimiento" o "ganancia de anti-saturaci贸n". Cuando el actuador se satura, esta realimentaci贸n "recorta" la parte integral para que el valor de la salida del integrador sea el que se corresponder铆a con la se帽al que el actuador *realmente* puede producir. Esto asegura que el integrador no se sobreacumule y su valor se mantenga cercano al que ser铆a ideal en condiciones no saturadas.

La ganancia $T_t$ (tiempo de seguimiento) es un par谩metro crucial en esta estrategia. Un valor com煤nmente utilizado para $T_t$ es $T_t = \sqrt{T_i T_d}$ o $T_t = T_i$, aunque su sintonizaci贸n precisa depende del sistema. Este m茅todo permite una transici贸n significativamente m谩s fluida y r谩pida cuando el actuador entra o sale de la saturaci贸n, minimizando de manera efectiva los efectos negativos del *wind-up* en la respuesta del sistema. Es uno de los m茅todos preferidos en la pr谩ctica industrial debido a su eficacia y a su facilidad de implementaci贸n en sistemas digitales.

### 3.3.1. Efectos de la Implementaci贸n del Anti Wind-up

La integraci贸n de estrategias anti *wind-up* tiene un impacto sustancialmente positivo en el rendimiento y la robustez del sistema de control, especialmente en aplicaciones donde los actuadores pueden alcanzar frecuentemente sus l铆mites de operaci贸n. Estas estrategias son fundamentales para mantener la integridad del proceso y asegurar un comportamiento predecible del sistema.

**Ejemplo 10:** Las siguientes gr谩ficas ilustran el efecto de la implementaci贸n de una estrategia anti *wind-up* en la respuesta del sistema, comparando diferentes valores del tiempo de seguimiento ($T_t$).

![Efectos del Anti Wind-up](http://googleusercontent.com/ontology/media/images/c04b4070_887e_41b1_80ed_43997ef057e9)
Figura 8. Comparaci贸n de los efectos del anti wind-up con diferentes tiempos de seguimiento ($T_t$).

Como se puede observar en la Figura 8, una sintonizaci贸n adecuada de $T_t$ (por ejemplo, $T_t = 0.1$ o $T_t = 1$) mejora considerablemente la respuesta del sistema. En presencia de saturaci贸n del actuador, las curvas con anti-*wind-up* exhiben un sobreimpulso significativamente menor y un tiempo de asentamiento m谩s r谩pido en comparaci贸n con un controlador sin una estrategia anti-*wind-up* (o con un $T_t$ mal ajustado, como $T_t = 3$ o $T_t = 2$, que a煤n muestra efectos negativos). Esto subraya la criticidad de elegir la estrategia anti *wind-up* apropiada y de sintonizarla correctamente para cada aplicaci贸n particular, garantizando as铆 un control eficiente y fiable.

---

# Ejercicios Resueltos

 1. **Ejercicio 1: Sintonizaci贸n PID con Ziegler & Nichols (Ciclo ltimo)**

Se dispone de un sistema cuya funci贸n de transferencia en lazo abierto es $G(s) = \frac{1}{s^{3}+6s^{2}+11s+6}$. Se requiere sintonizar un controlador PID utilizando el m茅todo de Ziegler & Nichols (ciclo 煤ltimo). Determine la ganancia 煤ltima ($K_u$) y el periodo 煤ltimo ($P_u$), y subsiguientemente, calcule los par谩metros ($K_p$, $T_i$, $T_d$) del controlador PID.

**Soluci贸n Detallada:**

La funci贸n de transferencia de la planta ya est谩 expandida como :
$$G(s) = \frac{1}{s^{3}+6s^{2}+11s+6}$$

Para aplicar el m茅todo de Ziegler & Nichols (ciclo 煤ltimo), se considera un controlador proporcional $C(s) = K_p$ en un sistema de lazo cerrado con realimentaci贸n unitaria. La funci贸n de transferencia en lazo cerrado $G_o(s)$ es:

$$G_o(s) = \frac{C(s)G(s)}{1 + C(s)G(s)} = \frac{K_p \cdot \frac{1}{s^{3}+6s^{2}+11s+6}}{1 + K_p \cdot \frac{1}{s^{3}+6s^{2}+11s+6}}$$

El polinomio caracter铆stico del sistema en lazo cerrado es el denominador de $G_o(s)$ igualado a cero:
$$s^{3}+6s^{2}+11s+6+K_{p} = 0$$

Para encontrar la condici贸n de oscilaci贸n marginalmente estable, donde los polos del sistema se encuentran sobre el eje imaginario, se sustituye $s = j\omega$ en el polinomio caracter铆stico:
$$(j\omega)^{3}+6(j\omega)^{2}+11(j\omega)+6+K_{p} = 0$$Recordando que $j^2 = -1$ y $j^3 = -j$:$$-j\omega^3 - 6\omega^2 + j11\omega + 6 + K_p = 0$$

Agrupamos los t茅rminos reales y los t茅rminos imaginarios :
$$(6+K_p - 6\omega^2) + j(11\omega - \omega^3) = 0$$

Para que esta ecuaci贸n compleja sea igual a cero, tanto su parte real como su parte imaginaria deben ser individualmente iguales a cero.

**1. Igualando la Parte Imaginaria a Cero:**
$$11\omega - \omega^3 = 0$$Factorizamos $\omega$:$$\omega(11 - \omega^2) = 0$$
Esta ecuaci贸n produce tres soluciones para $\omega$:
* $\omega = 0$ (corresponde al estado estacionario, no a una oscilaci贸n)
* $11 - \omega^2 = 0 \implies \omega^2 = 11 \implies \omega = \pm\sqrt{11}$

La frecuencia de oscilaci贸n no trivial es $\omega_u = \sqrt{11}$ rad/s. Este valor es la **frecuencia 煤ltima de oscilaci贸n**.

**2. Igualando la Parte Real a Cero:**
$$6+K_p - 6\omega^2 = 0$$Ahora, sustituimos el valor de $\omega^2 = 11$ que obtuvimos de la parte imaginaria:$$6+K_p - 6(11) = 0$$$$6+K_p - 66 = 0$$$$K_p - 60 = 0$$
$$K_p = 60$$

Este valor de $K_p$ es la **ganancia 煤ltima** ($K_u = 60$). Es la ganancia que lleva al sistema al umbral de la estabilidad, resultando en oscilaciones sostenidas.

Con la frecuencia 煤ltima de oscilaci贸n $\omega_u = \sqrt{11}$ rad/s, el **periodo 煤ltimo** ($P_u$) se calcula como el inverso de la frecuencia angular dividido por $2\pi$:
$$P_u = \frac{2\pi}{\omega_u} = \frac{2\pi}{\sqrt{11}} \approx 1.894 \text{ segundos}$$

Finalmente, se utilizan los valores de $K_u = 60$ y $P_u \approx 1.894$ segundos en la Tabla 1 para determinar los par谩metros del controlador PID. Seg煤n las reglas de Ziegler & Nichols para un controlador PID:

* **Ganancia Proporcional ($K_p$):**
    $K_p = 0.6 \times K_u = 0.6 \times 60 = 36$

* **Tiempo Integral ($T_i$):**
    $T_i = \frac{P_u}{2} = \frac{1.894}{2} = 0.947 \text{ segundos}$

* **Tiempo Derivativo ($T_d$):**
    $T_d = \frac{P_u}{8} = \frac{1.894}{8} = 0.23675 \text{ segundos}$

Por lo tanto, los par谩metros del controlador PID sintonizado por el m茅todo de Ziegler & Nichols son: $K_p = 36$, $T_i = 0.947$ s, y $T_d = 0.23675$ s.

 2. **Ejercicio 2: Identificaci贸n y Mitigaci贸n del Fen贸meno *Wind-up***

En un sistema de control de temperatura de un horno, se ha implementado un controlador PI. Durante la operaci贸n, se observa que la se帽al de salida del actuador (un calefactor) se mantiene constantemente en su valor m谩ximo durante un intervalo prolongado, incluso despu茅s de que la temperatura del horno ha alcanzado o incluso excedido ligeramente el punto de ajuste deseado. Posteriormente, cuando el punto de ajuste se reduce, la temperatura del horno experimenta un retardo significativo en su disminuci贸n, a pesar de que el calefactor se encuentra en estado de apagado. Describa el fen贸meno que se est谩 manifestando, sus causas fundamentales y proponga una estrategia de mitigaci贸n efectiva.

**Soluci贸n Detallada:**

El fen贸meno observado en el sistema de control de temperatura del horno es inequ铆vocamente el **Fen贸meno *Wind-up*** o acumulaci贸n integral.

**Causas Fundamentales del Fen贸meno *Wind-up*:**
El *wind-up* se origina porque el controlador PI, al incorporar una acci贸n integral ($K_i \int e(t) dt$), contin煤a acumulando el error ($e(t) = y_{sp} - y(t)$) entre el punto de ajuste ($y_{sp}$) y la temperatura actual del horno ($y(t)$), incluso cuando el actuador (el calefactor) ya ha alcanzado su l铆mite de saturaci贸n (es decir, est谩 operando a su capacidad m谩xima de calentamiento). En esta situaci贸n, aunque el actuador no puede inyectar m谩s calor en el horno, el error positivo persistente es integrado continuamente por el t茅rmino integral del controlador. Esto provoca que el valor interno del integrador ($I(t) = K_i \int e(t) dt$) se incremente a un nivel desproporcionadamente grande, excediendo el valor que ser铆a necesario para llevar la temperatura al punto de ajuste si el actuador no estuviera saturado.

Cuando la temperatura del horno finalmente alcanza el punto de ajuste (o lo sobrepasa), o cuando el punto de ajuste se reduce, el t茅rmino integral sobredimensionado debe "descargarse" (es decir, integrarse en la direcci贸n opuesta) hasta un valor apropiado antes de que la se帽al de control calculada por el controlador pueda salir de la zona de saturaci贸n y generar una acci贸n correctiva efectiva (en este caso, una se帽al para reducir el calor o apagar el calefactor). Este proceso de descarga consume un tiempo considerable, lo que explica el retardo significativo en la disminuci贸n de la temperatura. En la pr谩ctica, el controlador sigue enviando una se帽al que implica "demasiado calor" (o no suficiente enfriamiento) debido a la inercia del integrador sobredimensionado.

**Estrategia de Mitigaci贸n Efectiva:**
Para mitigar el *wind-up* en este escenario, se recomienda enf谩ticamente la implementaci贸n de una estrategia anti-*wind-up*. Una de las m谩s robustas y ampliamente utilizadas es el **Anti Wind-up por Rec谩lculo y Seguimiento (Tracking Anti-Wind-up)**.

* **Anti Wind-up por Rec谩lculo y Seguimiento:** Esta estrategia modifica el comportamiento del integrador para que su salida "siga" la salida real del actuador cuando este se satura. Consiste en realimentar la se帽al de salida real del actuador (la se帽al saturada) al integrador. Si la se帽al de control calculada por el controlador excede los l铆mites del actuador, la diferencia entre la se帽al calculada y la se帽al real del actuador se realimenta al integrador a trav茅s de una ganancia espec铆fica (relacionada con el "tiempo de seguimiento", $T_t$). Esto corrige el valor del integrador "en l铆nea", evitando que se acumule excesivamente.
    * **Ventaja:** Asegura que el valor del integrador se mantenga cercano al valor que ser铆a apropiado si el actuador no estuviera saturado. Esto permite una transici贸n mucho m谩s suave y una recuperaci贸n significativamente m谩s r谩pida del controlador una vez que las condiciones de saturaci贸n cesan. El sistema exhibir谩 un sobreimpulso reducido y un tiempo de asentamiento mejorado, lo que resulta en un control m谩s preciso y eficiente de la temperatura del horno.

La implementaci贸n de esta o de otras estrategias anti-*wind-up* es esencial para garantizar la robustez y el desempe帽o adecuado de los controladores PID en sistemas con actuadores limitados.

---

## 4. Conclusiones

La presente investigaci贸n ha profundizado en los principios y metodolog铆as de dise帽o y sintonizaci贸n de controladores PID en lazo cerrado, destacando su relevancia fundamental en la ingenier铆a mecatr贸nica. A partir del an谩lisis realizado, se establecen las siguientes conclusiones clave:

* **Eficiencia de la Sintonizaci贸n en Lazo Cerrado:** Las pruebas en lazo cerrado permiten un enfoque aplicable en la industria. Facilitan la caracterizaci贸n din谩mica precisa de un sistema bajo sus condiciones operativas normales, lo cual es ventajoso en entornos donde la interrupci贸n del proceso para pruebas en lazo abierto es inviable o costosa. Esto contribuye a una sintonizaci贸n m谩s representativa y, por ende, a un desempe帽o de control superior.
* **Pertinencia del M茅todo de Ziegler & Nichols:** A pesar de su antig眉edad, el m茅todo de Ziegler & Nichols de lazo cerrado se sigue utilizando bastante en la actualidad. Proporciona un punto de partida accesible para obtener una sintonizaci贸n inicial razonable de los controladores PID, siendo especialmente 煤til en la ausencia de modelos precisos del sistema.
* **Ventajas del M茅todo del Rel茅:** Muchos autores han propuesto m茅todos de sintonizaci贸n basados en los par谩metros del m茅todo del rel茅. El M茅todo del Rel茅 se consolida como una t茅cnica de sintonizaci贸n superior, al ofrecer una forma m谩s controlada y menos intrusiva de inducir las oscilaciones necesarias para la identificaci贸n de par谩metros. Su capacidad para evitar la saturaci贸n excesiva de la se帽al de control y su utilidad como base para sistemas de autosintonizaci贸n lo posicionan como una herramienta de mayor flexibilidad y seguridad en comparaci贸n con Ziegler & Nichols, especialmente en aplicaciones industriales.
* **Manejo Cr铆tico del Fen贸meno *Wind-up*:** En las implementaciones reales, es necesario tener en cuenta el fen贸meno *wind-up* e implementar alguna estrategia anti-*wind-up*. Es imperativo integrar estrategias anti-*wind-up* (como la saturaci贸n integral, integraci贸n condicional o, preferentemente, el rec谩lculo y seguimiento) para asegurar que, incluso cuando los actuadores operan en sus l铆mites de saturaci贸n, el rendimiento del sistema no se degrade y la respuesta se mantenga robusta y predecible. Ignorar este fen贸meno puede llevar a un comportamiento oscilatorio indeseado y a una respuesta lenta del sistema.

En s铆ntesis, el dise帽o y sintonizaci贸n de controladores PID en lazo cerrado constituye una disciplina que amalgama principios te贸ricos con la experimentaci贸n pr谩ctica. Un dominio exhaustivo de estas metodolog铆as y una comprensi贸n profunda de los fen贸menos operativos, como el *wind-up*, son esenciales para el desarrollo e implementaci贸n de sistemas de control eficientes, robustos y fiables en el campo de la ingenier铆a mecatr贸nica moderna.

---

## 5. Referencias

* [1] Cote Ballesteros, Jorge Eduardo. "Dise帽o de controladores PID lazo cerrado". Diapositivas de clase M7A Sistemas de Control I. Escuela Tecnol贸gica Instituto T茅cnico Central, 2023.
* [2] Astr枚m, K.J. y T. H盲gglund. "Benchmark Systems for PID Control". IFAC Workshop on Digital Control: Past, Present and Future of PID Control, Terrassa, Espa帽a, Abril 5-7, 2000.
