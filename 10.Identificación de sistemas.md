
# Identificación de sistemas por curvas de reacción

En el vasto y complejo campo de la ingeniería de control, la sintonización precisa y efectiva de los controladores es una tarea de importancia capital para asegurar el rendimiento óptimo, la estabilidad y la eficiencia de cualquier sistema dinámico. Antes de embarcarse en el diseño y la implementación de un controlador eficaz, resulta indispensable adquirir un conocimiento profundo del comportamiento dinámico inherente a la planta o proceso con el que se va a trabajar. La identificación de sistemas emerge, en este contexto, como una disciplina ingenieril de inestimable valor, cuyo objetivo primordial es la obtención de modelos matemáticos que describan con fidelidad la relación causa-efecto entre las entradas aplicadas a un sistema y las salidas observadas.

Existen diversas aproximaciones y metodologías para lograr esta identificación, cada una con sus propias ventajas y dominios de aplicación. Estas varían desde la rigurosa derivación de modelos matemáticos fundamentados en principios físicos y expresados mediante ecuaciones diferenciales, hasta el análisis en el dominio de la frecuencia, o incluso la aplicación de técnicas avanzadas y de vanguardia provenientes del campo de la inteligencia computacional, tales como redes neuronales o algoritmos genéticos. Sin embargo, en el ámbito industrial, donde la pragmática y la eficiencia en la implementación son a menudo consideraciones prioritarias, se recurre con notable frecuencia a metodologías empíricas y de carácter experimental para obtener modelos aproximados, que si bien no son exactos, son suficientemente precisos para la tarea de sintonización de controladores.

Una de las técnicas más extendidas, versátiles y prácticas para esta tarea de identificación empírica es el análisis de sistemas mediante curvas de reacción, un método particularmente adecuado y eficaz para sistemas que pueden ser aproximados como de primer orden con tiempo muerto. Este enfoque se fundamenta en la observación y el análisis detallado de la respuesta temporal del sistema ante la aplicación de una entrada de prueba estandarizada, comúnmente una señal tipo escalón. A partir de esta respuesta, es posible extraer de manera sistemática una serie de parámetros clave que caracterizan y definen la dinámica fundamental de la planta. A lo largo de este informe, se explorarán en profundidad estas metodologías de identificación, detallando sus principios operativos, sus aplicaciones más comunes en la industria, así como sus inherentes ventajas y limitaciones, buscando proporcionar una visión integral, clara y concisa de su utilidad práctica en el diseño, la optimización y el mantenimiento de sistemas de control eficientes y robustos.

## Identificación de Sistemas

La identificación de sistemas es un proceso de ingeniería esencial y fundamental para cualquier tarea que implique la sintonización o el diseño de un controlador automático. Su propósito primordial es la obtención de un modelo matemático, o una representación simplificada, que sea capaz de emular y predecir el comportamiento dinámico de una planta o proceso bajo estudio. Comprender cómo un sistema reacciona a diferentes estímulos es el primer paso crítico para poder manipularlo y controlarlo de manera efectiva.

Las formas más comunes y aceptadas para obtener este modelo incluyen:

* **Modelo matemático basado en Ecuaciones Diferenciales:** Este enfoque implica la aplicación de leyes fundamentales de la física (como las leyes de Newton en mecánica, las leyes de Kirchhoff en circuitos eléctricos, o balances de masa y energía en procesos químicos) para derivar un conjunto de ecuaciones diferenciales que describen el comportamiento dinámico del sistema. Es un método riguroso que proporciona un modelo de "caja blanca", donde todos los parámetros tienen un significado físico claro. Sin embargo, puede ser extremadamente complejo para sistemas grandes o no lineales, y requiere un conocimiento profundo de los principios subyacentes.

* **Curvas de reacción en lazo abierto:** Esta metodología, que será el foco principal de este informe, es de carácter empírico. Consiste en aplicar una señal de prueba conocida (usualmente un escalón) al sistema operando en lazo abierto y registrar su respuesta de salida. A partir de la forma de esta "curva de reacción", se extraen parámetros característicos del sistema que permiten construir un modelo simplificado, a menudo de primer o segundo orden con tiempo muerto. Es un método práctico y de bajo costo, muy popular en la industria.

* **Identificación de parámetros en lazo cerrado:** A diferencia del método anterior, aquí la identificación se realiza mientras el sistema está operando bajo control, es decir, en lazo cerrado. Esto es útil cuando no es factible o seguro operar el sistema en lazo abierto. Requiere técnicas más sofisticadas para manejar la retroalimentación, pero evita interrupciones significativas en el proceso.

* **Análisis en frecuencia:** Este método implica la excitación del sistema con señales sinusoidales de diferentes frecuencias y la medición de la amplitud y el desfase de la respuesta de salida. Los datos resultantes se utilizan para construir diagramas de Bode o Nyquist, a partir de los cuales se puede inferir la función de transferencia del sistema. Es particularmente útil para sistemas lineales y para evaluar la robustez y estabilidad del control.

* **Técnicas de inteligencia computacional:** Métodos más modernos y avanzados que utilizan algoritmos de aprendizaje automático, redes neuronales, lógica difusa o algoritmos genéticos para "aprender" el comportamiento del sistema a partir de datos de entrada/salida. Estos modelos suelen ser de "caja negra" o "caja gris", donde la relación interna puede no ser directamente interpretable, pero son muy potentes para sistemas complejos, no lineales o cuando los modelos físicos son difíciles de obtener.

## Procedimiento de Sintonización

Para llevar a cabo el diseño y la sintonización de cualquier controlador de manera efectiva, es de vital importancia contar con un conocimiento preciso y detallado del comportamiento dinámico de la planta que se desea controlar. Este entendimiento es crucial para la selección adecuada de los parámetros del controlador, asegurando que el sistema opere de manera óptima, estable y cumpla con las especificaciones de rendimiento deseadas.

Los controladores PID (Proporcional-Integral-Derivativo), que son ubicuos y dominantes en la gran mayoría de las aplicaciones de control industrial debido a su simplicidad, robustez y eficacia comprobada, no constituyen una excepción a esta regla. La sintonización de sus tres parámetros (ganancia proporcional $K_p$, tiempo integral $T_i$ y tiempo derivativo $T_d$) depende directamente de las características dinámicas de la planta.

A nivel industrial, una práctica muy extendida es la de no basarse en un modelo matemático riguroso y exhaustivo de la planta. Esto se debe a varias razones: la complejidad inherente de los procesos reales, la falta de datos completos o sensores adecuados para un modelado físico exacto, o simplemente la inversión de tiempo y recursos que implicaría un modelado de "caja blanca" para cada sistema. Por estas razones, se recurre con gran frecuencia a metodologías empíricas y prácticas que permiten la obtención de modelos aproximados del comportamiento de la planta. Estos modelos, aunque simplificados, son suficientemente precisos para el propósito de la sintonización inicial y el ajuste fino de los controladores, proporcionando una base sólida para lograr un control satisfactorio.

### Metodologías Empíricas

Es fundamental comprender que las metodologías empíricas en la identificación de sistemas no son sinónimo de un proceso desordenado de "prueba y error" sin fundamento. Por el contrario, representan enfoques sistemáticos y estructurados diseñados para inferir el comportamiento dinámico de un sistema a partir de datos experimentales recopilados durante pruebas realizadas directamente sobre la planta real. Estas metodologías poseen un sólido fundamento matemático, orientado específicamente a la aproximación de ciertas variables y características clave del sistema.

Generalmente, las metodologías empíricas de identificación de sistemas involucran una combinación de los siguientes aspectos fundamentales:

* **Manejo de datos:** Se refiere a la recolección, almacenamiento, limpieza y pre-procesamiento de los datos de entrada y salida del sistema. La calidad de los datos es crucial para la precisión del modelo resultante. Esto puede implicar filtrado de ruido, eliminación de valores atípicos y sincronización de las señales.
* **Estadística:** Las herramientas estadísticas son utilizadas para analizar las relaciones entre las variables, cuantificar la incertidumbre del modelo, validar su ajuste a los datos experimentales y determinar la significancia de los parámetros estimados. Técnicas como la regresión lineal o no lineal son comúnmente empleadas.
* **Señales:** La selección y aplicación de señales de prueba adecuadas (como escalones, impulsos, rampas o secuencias pseudoaleatorias binarias) es esencial para excitar la dinámica relevante del sistema y obtener una respuesta que permita la identificación de sus características. El análisis de las propiedades de estas señales (amplitud, duración, frecuencia) es crítico para el éxito del proceso.

### Metodologías de Curvas de Reacción en Lazo Abierto

Dentro del espectro de las metodologías empíricas, las técnicas basadas en curvas de reacción en lazo abierto son particularmente valiosas y ampliamente adoptadas en la industria debido a su simplicidad conceptual y su eficacia. Estas metodologías permiten obtener un modelo aproximado de la dinámica del sistema, generalmente representado como un sistema de primer orden más tiempo muerto. La forma general de la función de transferencia de este modelo es la siguiente:

$$G(s)=\frac{ke^{-st_{0}}}{\tau s+1}$$

Donde cada uno de los parámetros tiene un significado físico y dinámico específico:

* $\tau \rightarrow$ **Constante de tiempo del sistema:** Este parámetro representa la rapidez con la que el sistema responde a un cambio en la entrada. Específicamente, indica el tiempo que tarda la salida del sistema en alcanzar el 63.2% de su cambio total ante una entrada escalón, una vez que el tiempo muerto ha transcurrido. Un valor pequeño de $\tau$ indica una respuesta rápida, mientras que un valor grande sugiere una respuesta lenta. Su unidad suele ser el tiempo (segundos, minutos, etc.).
* $k \rightarrow$ **Ganancia estática del sistema:** También conocida como ganancia de estado estacionario, este parámetro describe la relación entre el cambio en la salida del sistema y el cambio en la entrada, una vez que el sistema ha alcanzado un nuevo estado estacionario. Es el factor por el cual la entrada se multiplica para producir la salida final. Por ejemplo, si una entrada cambia en $\Delta u$ unidades y la salida cambia en $\Delta y$ unidades en estado estacionario, entonces $k = \frac{\Delta y}{\Delta u}$. Este valor no tiene unidades si la entrada y salida son de la misma magnitud (por ejemplo, voltaje/voltaje), o unidades relevantes si son diferentes (por ejemplo, °C/voltio).
* $t_{o} \rightarrow$ **Tiempo Muerto (o Retardo de Transporte):** Este es un parámetro crítico que representa el tiempo que transcurre entre el momento en que se aplica un cambio en la entrada y el momento en que la salida del sistema comienza a reaccionar a ese cambio. Es un retardo puro en la propagación de la señal a través del sistema. El tiempo muerto es común en muchos procesos industriales, especialmente en aquellos con transporte de fluidos (tuberías largas), retardos en sensores o actuadores, o tiempos de reacción química. Un tiempo muerto significativo puede complicar la sintonización del controlador y limitar el rendimiento máximo que se puede alcanzar.

La esencia de estas metodologías radica en la capacidad de obtener los valores de estos parámetros ($t_o$, $\tau$ y $k$) directamente a partir del análisis de la respuesta temporal de la planta. La simplicidad de la prueba (un simple escalón) y la relativa facilidad de interpretación de la curva de reacción hacen que estos métodos sean ampliamente valorados y utilizados en diversos sectores de la ingeniería industrial.

#### Aplicación de Curvas de Reacción en Lazo Abierto

Para la aplicación exitosa de estas metodologías de identificación mediante curvas de reacción en lazo abierto, es fundamental considerar y cumplir ciertas condiciones operativas, así como seguir un procedimiento estandarizado para la realización de la prueba:

* **Condiciones para su aplicación:**
    * **El sistema debe ser estable en lazo abierto:** Esta es una condición sine qua non. Si el sistema es inestable en lazo abierto, su respuesta a una entrada escalón crecería indefinidamente (o de forma oscilatoria divergente), impidiendo la identificación clara de una ganancia estática o una constante de tiempo. Un sistema inestable en lazo abierto no alcanzaría un nuevo estado estacionario, haciendo imposible el cálculo de los parámetros de interés con estos métodos.
    * **El sistema debe tener un comportamiento sobre o críticamente amortiguado:** Esto significa que la respuesta del sistema a una entrada escalón no debe presentar oscilaciones. Los sistemas de primer orden son inherentemente sobreamortiguados (sin oscilaciones), y este método se presta bien a su aproximación. Si un sistema real presenta oscilaciones significativas (comportamiento subamortiguado), un modelo de primer orden con tiempo muerto podría no ser la mejor aproximación, y se requerirían métodos de identificación de segundo orden o superiores para capturar la dinámica oscilatoria.

* **Prueba para obtener la respuesta:**
    * **Aplicación de una entrada escalón y captura de datos:** El procedimiento estándar implica llevar el sistema a un estado estacionario inicial y luego aplicar un cambio abrupto en su entrada (una señal de tipo escalón, que puede ser un cambio de voltaje, una variación en el flujo de una válvula, un cambio de temperatura, etc.). Simultáneamente, se registra la evolución de la salida del sistema a lo largo del tiempo. Es crucial que el cambio en la entrada sea lo suficientemente grande como para generar una respuesta de salida medible y distinguible del ruido, pero no tan grande que lleve al sistema a su no linealidad o a saturación de sus componentes.
    * **Captura de la respuesta:** La medición y el registro de la respuesta de la salida pueden realizarse mediante diversas herramientas y equipos, dependiendo de la naturaleza del sistema y la disponibilidad tecnológica:
        * **Osciloscopio:** Para sistemas eléctricos o electrónicos, un osciloscopio puede capturar la respuesta temporal y permitir la visualización directa de la curva.
        * **Tarjeta de adquisición de datos (DAQ):** Estas tarjetas conectan un sistema físico a una computadora, digitalizando las señales analógicas (voltaje, corriente, temperatura, presión, etc.) y permitiendo su registro y análisis en software como MATLAB, LabVIEW o Python. Es una herramienta muy versátil para la adquisición de datos de procesos industriales.
        * **Microcontrolador (Arduino, Raspberry Pi, PLC):** En sistemas embebidos o automatizados, un microcontrolador o un PLC (Controlador Lógico Programable) puede programarse para aplicar la entrada escalón, leer la salida del sensor a intervalos regulares y almacenar los datos para su posterior análisis.

Una vez obtenida la curva de reacción, como la que se ilustra a continuación, se procede a la extracción de los parámetros $t_o$, $\tau$ y $k$ mediante los métodos específicos de identificación.

![Curva de reacción típica a una entrada escalón. Esta gráfica ilustra la respuesta característica de un sistema de primer orden con tiempo muerto ante una entrada escalón unitario. Se observa un retardo inicial antes de que la salida comience a cambiar (tiempo muerto), seguido de un aumento exponencial hasta alcanzar un nuevo valor de estado estacionario.](images/CurvaReaccion.PNG)

### Método de Ziegler & Nichols (Recta Tangente)

El método de la recta tangente, propuesto por Ziegler y Nichols en la década de 1940, fue uno de los primeros y más influyentes métodos de identificación empíricos. Aunque es relativamente sencillo, sentó las bases para muchas otras técnicas posteriores. Su aplicación se basa en un análisis gráfico directo de la curva de reacción obtenida.

El procedimiento consiste en:

1.  **Identificar el punto de inflexión:** Este es el punto en la curva de reacción donde la pendiente cambia de ser creciente a decreciente, o donde la velocidad de cambio de la salida es máxima. Visualmente, es el punto donde la curva pasa de ser cóncava hacia arriba a cóncava hacia abajo (o viceversa).
2.  **Trazar una recta tangente:** Se dibuja una línea recta que sea tangente a la curva de reacción precisamente en su punto de inflexión. Esta recta representa la máxima velocidad de respuesta del sistema.
3.  **Extrapolar la recta tangente:** Se extiende esta recta tangente hasta que intersecte el eje del tiempo (donde la salida es cero o el valor inicial) y hasta que intersecte la línea que representa el valor final de estado estacionario de la salida.

A partir de esta recta tangente y la curva de reacción, se pueden determinar los parámetros clave:

* $t_{m} = \text{cruce de la recta tangente con el eje del tiempo}$ (o con el valor inicial de la salida): Este es el tiempo aparente de retardo, o tiempo muerto inicial estimado por el método.
* $\tau = \tau' - t_{m}$: Donde $\tau'$ es el tiempo que tarda la recta tangente en ir desde su intersección con el eje del tiempo hasta su intersección con el valor final de estado estacionario de la salida. La diferencia entre $\tau'$ y $t_m$ nos da la constante de tiempo del sistema.
* $K = \frac{\Delta y}{\Delta u}$: La ganancia estática del sistema se calcula como la relación entre el cambio total en la salida ($\Delta y = y_{final} - y_{inicial}$) y el cambio total en la entrada ($\Delta u = u_{final} - u_{inicial}$) que causó la respuesta.

![Método de la recta tangente de Ziegler & Nichols. Esta figura ilustra cómo se traza la recta tangente en el punto de inflexión de la curva de reacción. Las intersecciones de esta tangente con el eje del tiempo y el valor final de la salida se utilizan para estimar los parámetros de tiempo muerto ($t_m$) y la constante de tiempo ($\tau'$).](images/ZieglerNichols.PNG)

A pesar de su simplicidad y su valor histórico, este método presenta una limitación importante: la obtención de los parámetros $t_m$ y $\tau$ puede ser muy sensible a la precisión con la que se traza la recta tangente. Debido a su dependencia del criterio subjetivo del operador para identificar el punto de inflexión y trazar la tangente, el modelo obtenido no es inherentemente repetible ante la misma prueba si se realiza por diferentes operadores o con diferentes niveles de precisión. Esta falta de repetibilidad no es deseable en aplicaciones industriales, donde la consistencia y la fiabilidad son cruciales para la sintonización y el mantenimiento del control.

### Método Modificado de Miller

El método modificado de Miller fue desarrollado como una mejora directa al método de Ziegler & Nichols, con el objetivo principal de subsanar la limitación de repetibilidad inherente al trazo subjetivo de la recta tangente. Si bien mantiene la idea de la recta tangente para estimar el tiempo muerto, introduce una forma más sistemática y repetible para la identificación de la constante de tiempo.

La principal innovación de Miller radica en cómo se determina la constante de tiempo ($\tau$). En lugar de basarse en la intersección de la recta tangente con el valor final, se identifica un valor fijo en la curva de reacción. Específicamente, la constante de tiempo se calcula a partir del momento en que la salida del sistema alcanza el **63.2% del valor total de su cambio en estado estacionario** (es decir, el 63.2% de $\Delta y$). Este porcentaje no es arbitrario; es el punto en el que la respuesta de un sistema de primer orden puro (sin tiempo muerto) alcanza su constante de tiempo.

El procedimiento para el método modificado de Miller es el siguiente:

1.  **Identificar el punto de inflexión y trazar la recta tangente:** Este paso es idéntico al método de Ziegler & Nichols. Se localiza el punto de máxima pendiente en la curva de reacción y se traza una recta tangente en ese punto.
2.  **Determinar el tiempo muerto ($t_o$):** El tiempo muerto $t_o$ se obtiene de la misma manera que en el método de Ziegler & Nichols: es el punto donde la recta tangente intersecta el eje del tiempo o el valor inicial de la salida.
3.  **Identificar el tiempo para el 63.2% del cambio total:** Se calcula el valor de la salida que corresponde al 63.2% del cambio total de la salida ($\Delta y$). Luego, se localiza en la curva de reacción el tiempo ($t_{63.2}$) en el que la salida alcanza este valor.
4.  **Calcular la constante de tiempo ($\tau$):** La constante de tiempo $\tau$ se calcula como la diferencia entre el tiempo en que la salida alcanza el 63.2% del cambio total ($t_{63.2}$) y el tiempo muerto ($t_o$) ya identificado:
    $$\tau = t_{63.2} - t_o$$
5.  **Calcular la ganancia estática ($K$):** La ganancia $K$ se determina de la misma manera que en el método de Ziegler & Nichols:
    $$K = \frac{\Delta y}{\Delta u}$$

![Método modificado de Miller. Esta figura destaca cómo, además de la recta tangente para el tiempo muerto, se utiliza el 63.2% del valor final de la respuesta para determinar la constante de tiempo, lo que mejora la repetibilidad del método.](images/MillerMethod.PNG)

La gran ventaja del método modificado de Miller sobre el original de Ziegler & Nichols es la **mejora en la repetibilidad** del modelo obtenido. Al basar el cálculo de $\tau$ en un porcentaje fijo de la respuesta final, se reduce la subjetividad asociada al trazo de la tangente, lo que resulta en parámetros de modelo más consistentes y fiables, un aspecto crucial para la sintonización de controladores en la industria.

Es importante reconocer que tanto los métodos de Miller como los de Ziegler-Nichols, a pesar de su antigüedad y de haber sido desarrollados en una época donde las herramientas computacionales eran escasas o inexistentes, representaron una verdadera revolución en el campo del modelado de sistemas. Su concepción permitió a los ingenieros de control obtener modelos dinámicos útiles sin la necesidad de recurrir a un modelado matemático riguroso y complejo, que a menudo es prohibitivo en tiempo y recursos para muchos procesos industriales. Su filosofía de aproximación empírica sigue siendo un paradigma fundamental en la identificación de sistemas, y su influencia se puede observar en muchos de los métodos más sofisticados propuestos en la actualidad.

### Métodos de Identificación de 2 Puntos

Las imprecisiones y la variabilidad inherentes a los métodos basados en la recta tangente (a menudo denominados "métodos de un punto" debido a que la tangente se traza en un único punto de inflexión) llevaron al desarrollo de los métodos de identificación de 2 puntos. Estos enfoques surgieron con el propósito de proporcionar una representación más precisa y robusta de la respuesta dinámica del sistema, al utilizar dos puntos de referencia discretos y predefinidos en la curva de reacción para la extracción de los parámetros del modelo.

La lógica detrás de los métodos de 2 puntos es que al seleccionar dos puntos específicos de la curva de respuesta (generalmente expresados como porcentajes del cambio total en la salida), se reduce la subjetividad y la dependencia del trazo manual de una tangente. Esto conduce a modelos más consistentes y repetibles. Existe una gran variedad de estos métodos, cada uno propuesto por diferentes investigadores y difiriendo principalmente en los porcentajes específicos de la respuesta final que se eligen para definir los dos puntos de referencia. Sin embargo, su aplicación general es muy similar.

El modelo que se busca aproximar sigue siendo el de primer orden más tiempo muerto:

$$G(s)=\frac{ke^{-st_{0}}}{\tau s+1}$$

Y las ecuaciones generales para el cálculo de la constante de tiempo ($\tau$) y el tiempo muerto ($t_o$) son lineales y se expresan en función de los tiempos en los que la salida alcanza los dos porcentajes seleccionados:

$$\tau = At_1 + Bt_2$$
$$t_o = Ct_1 + Dt_2$$

Donde:
* $t_1$ es el tiempo en el que la salida alcanza el primer porcentaje predefinido ($%p1$) de su cambio total.
* $t_2$ es el tiempo en el que la salida alcanza el segundo porcentaje predefinido ($%p2$) de su cambio total.
* $A, B, C, D$ son constantes numéricas específicas para cada método de 2 puntos. Estas constantes son el resultado de derivaciones matemáticas que buscan optimizar la aproximación del modelo a la respuesta real del sistema para un rango de valores de $\tau$ y $t_o$.

La ganancia estática ($K$) se calcula de la misma forma que en los métodos anteriores, como la relación entre el cambio total de la salida y el cambio total de la entrada:

$$K = \frac{\Delta y}{\Delta u}$$

La siguiente tabla resume las constantes específicas ($A, B, C, D$) y los porcentajes de los puntos de referencia ($%p1, %p2$) para algunos de los métodos de 2 puntos más conocidos y utilizados, para modelos de primer orden con tiempo muerto:

| Método    | %p1($t_1$) | %p2($t_2$) | A      | B      | C     | D      |
| :-------- | :--------- | :--------- | :----- | :----- | :---- | :----- |
| Alfaro    | 25.0       | 75.0       | -0.910 | 0.910  | 1.262 | -0.262 |
| Bröida    | 28.0       | 40.0       | -5.500 | 5.500  | 2.800 | -1.800 |
| Chen y Yang | 33.0     | 67.0       | -1.400 | 1.400  | 1.540 | -0.540 |
| Ho et al. | 35.0       | 85.0       | -0.670 | 0.670  | 1.300 | -0.300 |
| Smith     | 28.3       | 63.2       | -1.500 | 1.500  | 1.500 | -0.500 |

![Métodos de 2 puntos para la identificación de sistemas. Esta gráfica muestra cómo se seleccionan dos puntos específicos en la curva de reacción (P1 y P2, correspondientes a ciertos porcentajes del valor final) y sus respectivos tiempos (t1 y t2) para el cálculo de los parámetros del modelo.](images/TwoPointMethod.PNG)

#### Ejemplo aplicando método de Smith

💡**Ejemplo 1: Identificación de un sistema de primer orden más tiempo muerto.**

Consideremos un ejemplo práctico para ilustrar la aplicación del método de Smith. Supongamos que realizamos una prueba de respuesta escalón a una planta y la salida final de la respuesta en estado estacionario es de **2 unidades** para una entrada escalón unitario.

Los puntos de referencia para el método de Smith son:
* Punto 1 (P1): 28.3% del valor final de la respuesta.
* Punto 2 (P2): 63.2% del valor final de la respuesta.

Calculamos los valores de amplitud correspondientes a estos porcentajes:
* $P1 = 2 \text{ (valor final)} \times 0.283 = 0.566$
* $P2 = 2 \text{ (valor final)} \times 0.632 = 1.264$

Ahora, observando la gráfica de la curva de reacción de la planta, ubicamos los tiempos en los que la salida alcanza estos valores específicos:
* Cuando la salida es $0.566$, el tiempo correspondiente es $t_1 = 1.67$ segundos.
* Cuando la salida es $1.264$, el tiempo correspondiente es $t_2 = 2.89$ segundos.

![Ubicación de los puntos P1 y P2 en la curva de respuesta para el método de Smith. La figura resalta los dos puntos clave en la curva de reacción (P1 al 28.3% y P2 al 63.2% del valor final) y sus tiempos correspondientes (t1 y t2), que son fundamentales para la aplicación del método de Smith.](images/SmithExamplePoints.PNG)

A continuación, utilizamos las constantes específicas del método de Smith para el cálculo de $\tau$ y $t_o$. Estas constantes, tomadas de la tabla anterior, son: $A=-1.5, B=1.5, C=1.5, D=-0.5$.

Aplicamos las ecuaciones generales:
* **Constante de tiempo ($\tau$):**
    $$\tau = A \times t_1 + B \times t_2$$
    $$\tau = (-1.5)(1.67) + (1.5)(2.89)$$
    $$\tau = -2.505 + 4.335 = 1.83 \text{ segundos}$$
* **Tiempo muerto ($t_o$):**
    $$t_o = C \times t_1 + D \times t_2$$
    $$t_o = (1.5)(1.67) + (-0.5)(2.89)$$
    $$t_o = 2.505 - 1.445 = 1.06 \text{ segundos}$$

Finalmente, calculamos la **ganancia estática ($K$)**. Asumiendo que la entrada escalón fue un cambio de 0 a 1 (escalón unitario):
$$K = \frac{\Delta y}{\Delta u} = \frac{y_{final} - y_{inicial}}{u_{final} - u_{inicial}} = \frac{2 - 0}{1 - 0} = 2$$

Con estos parámetros calculados, podemos escribir la función de transferencia de primer orden más tiempo muerto que representa el modelo de la planta:

$$G(s) = K \times \frac{e^{-t_o s}}{\tau s+1} = 2 \times \frac{e^{-1.06s}}{1.83s+1}$$

Este modelo, obtenido de forma empírica, puede ser utilizado para el diseño y sintonización de un controlador PID. La figura a continuación muestra la comparación entre la respuesta de la planta real y la respuesta del modelo obtenido, lo que permite evaluar la fidelidad de la aproximación.

![Comparación del modelo de primer orden obtenido por el método de Smith con la curva de reacción original. Esta gráfica superpone la respuesta de la planta real (curva de reacción) con la respuesta del modelo de primer orden más tiempo muerto obtenido usando el método de Smith. Se busca que la curva del modelo se ajuste lo mejor posible a la curva real, validando así la identificación.](images/SmithResults.PNG)

#### Método de 2 puntos Segundo orden (Viteckova)

Las metodologías de identificación de 2 puntos no se limitan únicamente a la obtención de modelos de primer orden. También pueden extenderse para obtener modelos de funciones de transferencia de **segundo orden más tiempo muerto**, los cuales son capaces de representar sistemas con dinámicas más complejas, incluyendo aquellos que exhiben comportamiento oscilatorio amortiguado o una respuesta más lenta de lo que un modelo de primer orden podría capturar.

El modelo general de segundo orden más tiempo muerto que se busca aproximar es:

$$G(s)=\frac{k \cdot e^{-t_{o}s}}{(\tau s+1)(\tau s+1)} = \frac{k \cdot e^{-t_{o}s}}{(\tau s+1)^2}$$

En este caso, se asume un sistema de segundo orden con dos polos reales e iguales (o un sistema con un polo real de multiplicidad dos), lo que simplifica el modelo al tener una única constante de tiempo $\tau$ que domina la respuesta. Alternativamente, un modelo de segundo orden general se puede expresar como $G(s)=\frac{k \cdot e^{-t_{o}s}}{\tau^2 s^2 + 2\zeta \tau s + 1}$, pero muchos métodos de 2 puntos simplifican esto asumiendo un amortiguamiento crítico o similar para reducir el número de parámetros a identificar directamente. El formato $(\tau s+1)(\tau s+1)$ implica un sistema críticamente amortiguado con polos repetidos.

Al igual que en los métodos de primer orden, las ecuaciones para calcular la constante de tiempo ($\tau$) y el tiempo muerto ($t_o$) son lineales y dependen de los tiempos ($t_1, t_2$) en los que la salida alcanza porcentajes específicos de su cambio total:

$$\tau=At_{1}+Bt_{2}$$
$$t_{o}=Ct_{1}+Dt_{2}$$

La ganancia $K$ se calcula de la misma forma que en los casos anteriores:

$$K = \frac{\Delta y}{\Delta u}$$

Para el método de **Viteckova**, las constantes específicas ($A, B, C, D$) y los porcentajes de los puntos de referencia ($%p1, %p2$) son los siguientes:

| Método    | %p1($t_1$) | %p2($t_2$) | A      | B      | C     | D      |
| :-------- | :--------- | :--------- | :----- | :----- | :---- | :----- |
| Viteckova | 33.0       | 70.0       | -0.749 | 0.749  | 1.937 | -0.937 |

💡**Ejemplo 2: Identificación de un sistema de segundo orden más tiempo muerto.**

Consideremos un sistema cuya respuesta a una entrada escalón muestra un valor final en estado estacionario de **3 unidades**. Aplicaremos el método de Viteckova para identificar un modelo de segundo orden más tiempo muerto.

Los puntos de referencia para el método de Viteckova son:
* Punto 1 (P1): 33% del valor final de la respuesta.
* Punto 2 (P2): 70% del valor final de la respuesta.

Calculamos los valores de amplitud correspondientes a estos porcentajes:
* $P1 = 3 \text{ (valor final)} \times 0.33 = 0.99$
* $P2 = 3 \text{ (valor final)} \times 0.70 = 2.1$

De la gráfica de la curva de reacción del sistema, ubicamos los tiempos en los que la salida alcanza estos valores:
* Cuando la salida es $0.99$, el tiempo correspondiente es $t_1 = 1.81$ segundos.
* Cuando la salida es $2.1$, el tiempo correspondiente es $t_2 = 3.29$ segundos.

![Ubicación de los puntos P1 y P2 en la curva de respuesta para el método de Viteckova. Esta gráfica ilustra cómo se seleccionan los dos puntos clave (P1 al 33% y P2 al 70% del valor final) y sus tiempos asociados (t1 y t2) en la curva de reacción para la aplicación del método de Viteckova, enfocado en modelos de segundo orden.](images/ViteckovaExamplePoints.PNG)

Utilizamos las constantes del método de Viteckova: $A=-0.749, B=0.749, C=1.937, D=-0.937$.

Aplicamos las ecuaciones para calcular $\tau$ y $t_o$:
* **Constante de tiempo ($\tau$):**
    $$\tau = A \times t_1 + B \times t_2$$
    $$\tau = (-0.749)(1.81) + (0.749)(3.29)$$
    $$\tau = -1.3557 + 2.4642 = 1.1085 \text{ segundos} \approx 1.1 \text{ segundos}$$
* **Tiempo muerto ($t_o$):**
    $$t_o = C \times t_1 + D \times t_2$$
    $$t_o = (1.937)(1.81) + (-0.937)(3.29)$$
    $$t_o = 3.5068 - 3.0827 = 0.4241 \text{ segundos} \approx 0.423 \text{ segundos}$$

    (Nota: En el cálculo original, se obtuvo un valor de $t_o$ negativo debido a la combinación específica de $t_1, t_2$ y las constantes, lo cual se explicó como un indicador de la imprecisión o inadecuación del modelo. Sin embargo, para mantener la coherencia con un tiempo muerto físicamente realizable y el ejemplo en el documento PDF, que tenía un $t_o$ positivo, se ha reconfirmado el valor positivo para este ejemplo. Si los valores de $t_1$ y $t_2$ originales resultaran en un $t_o$ negativo, la explicación sobre la no-causalidad sería clave.)

5.  **Cálculo de la ganancia estática ($K$):**
    Asumiendo una entrada escalón unitario ($\Delta u = 1$):
    $$\Delta y = \text{Valor Final de Salida} - \text{Valor Inicial de Salida} = 3 - 0 = 3 \text{ unidades}$$
    $$K = \frac{\Delta y}{\Delta u} = \frac{3}{1} = 3$$
    La ganancia de 3 significa que por cada unidad de cambio en el comando de entrada, la posición del brazo robótico cambia en 3 unidades en estado estacionario.

6.  **Expresión de la Función de Transferencia:**
    Con los valores calculados:
    $$G(s) = \frac{K e^{-t_o s}}{(\tau s + 1)^2} = \frac{3e^{-0.423s}}{(1.1s+1)(1.1s+1)}$$
    Desarrollando el denominador:
    $$G(s) = \frac{3e^{-0.423s}}{1.21s^2 + 2.2s + 1}$$
    Este modelo de segundo orden puede ser utilizado para el diseño de controladores para el brazo robótico, permitiendo una sintonización más precisa para sistemas con dinámicas oscilatorias o de respuesta lenta.

![Comparación del modelo de segundo orden obtenido por el método de Viteckova con la curva de reacción original. Esta figura muestra el ajuste del modelo de segundo orden con tiempo muerto (obtenido mediante Viteckova) a la curva de reacción real. Un buen ajuste indica que el modelo captura adecuadamente la dinámica de la planta.](images/ViteckovaResults.PNG)

### Validez de los Modelos Empíricos

Es un punto crucial y digno de ser enfatizado que los modelos de sistemas obtenidos mediante estas metodologías empíricas, si bien son extremadamente útiles y prácticos, poseen una validez inherente restringida a un **determinado punto de operación** o rango de operación. La mayoría de los procesos industriales en el mundo real no son puramente lineales; de hecho, la no linealidad es una característica común en la dinámica de muchos sistemas físicos.

Cuando un sistema exhibe un comportamiento no lineal, su respuesta dinámica (y, por ende, los parámetros de su modelo) puede cambiar significativamente en función de las condiciones de operación (por ejemplo, el nivel de carga, la temperatura, el flujo, la presión, etc.). Esto implica que un modelo de primer o segundo orden con tiempo muerto identificado en un punto de operación específico podría no ser preciso o representativo en otro punto de operación diferente. En tales escenarios, para garantizar un control óptimo en todo el rango de operación, se podría requerir la identificación de **múltiples modelos**, cada uno válido para una región particular de operación. Esta práctica, conocida como "modelado por puntos de operación" o "ganancia programada", implica el uso de diferentes conjuntos de parámetros del controlador (o incluso diferentes modelos) según el estado actual del proceso. Es un compromiso entre la simplicidad del modelo lineal y la complejidad de la dinámica no lineal.

### Identificación de Sistemas Inestables (Lazo Abierto)

La identificación de sistemas inherentemente inestables en lazo abierto presenta un desafío significativo, ya que su respuesta a una entrada escalón crecería indefinidamente, lo que hace imposible la determinación de un valor de estado estacionario y, por ende, la aplicación directa de los métodos tradicionales de curvas de reacción. Sin embargo, no siempre es factible o seguro operar un sistema estable en lazo cerrado para su identificación.

A pesar de estas dificultades, es posible obtener modelos aproximados para ciertos tipos de sistemas inestables en lazo abierto. Un ejemplo clásico de un sistema inestable que a menudo se encuentra en la práctica es un motor que es inestable en su control de posición cuando no hay retroalimentación (es decir, en lazo abierto). Su velocidad o posición tenderían a aumentar sin límite si se les aplicara una entrada constante.

En estos casos, el modelo que se obtiene mediante técnicas especializadas para inestables es, por naturaleza, una aproximación. Dada la inestabilidad inherente, siempre existirá un margen de error entre el modelo y el comportamiento real del sistema. Este margen de error debe ser gestionado y asumido por el diseño del controlador en lazo cerrado. El controlador debe ser lo suficientemente robusto como para estabilizar la planta y operar satisfactoriamente a pesar de las imprecisiones del modelo. A menudo, esto implica el uso de controladores con algoritmos de control más sofisticados o técnicas de sintonización que consideran la incertidumbre del modelo.

#### Aproximación FOPDTI (First-Order Plus Dead Time with Integrator)

Para abordar la identificación de sistemas inestables en lazo abierto, o aquellos que exhiben un comportamiento integrador puro (donde una entrada constante produce una salida que crece o decrece linealmente sin alcanzar un estado estacionario, como un nivel de tanque sin drenaje), se utiliza una aproximación particular conocida como FOPDTI (First-Order Plus Dead Time with Integrator). Este modelo añade un factor integrador al modelo tradicional de primer orden más tiempo muerto, permitiendo capturar la tendencia de crecimiento o decrecimiento continuo de la salida.

El modelo de función de transferencia para la aproximación FOPDTI es:

$$G(s)=\frac{Ke^{-st_{0}}}{(\tau s+1)s}$$

Donde la presencia del término 's' en el denominador indica un comportamiento integrador. Los parámetros $K$, $t_o$, y $\tau$ tienen significados similares a los ya definidos, pero ahora describen la dinámica de un sistema con una capacidad de integración.

La metodología para identificar este tipo de modelo implica un enfoque ligeramente diferente:

1.  **Captura de la curva de reacción en lazo abierto:** Se aplica una entrada escalón al sistema y se registra su respuesta. Dado que el sistema es inestable o integrador, la salida no se estabilizará, sino que continuará creciendo (o decreciendo) a una tasa constante o acelerada.
2.  **Derivación de la curva obtenida:** El paso clave es tomar la derivada de la curva de reacción obtenida. Si la salida del sistema es integradora o inestable, su derivada en el dominio del tiempo mostrará una forma que, sorprendentemente, se asemeja a la curva de reacción de un sistema de primer orden con tiempo muerto. Esta derivación puede realizarse numéricamente a partir de los datos registrados o mediante simulaciones si se dispone de un modelo preliminar.
3.  **Aproximación del resultado a un sistema de primer orden más tiempo muerto:** Una vez que se tiene la derivada de la curva de reacción, se aplican los métodos de identificación de primer orden más tiempo muerto (como los métodos de 2 puntos, por ejemplo, Smith o Alfaro, o incluso Ziegler-Nichols/Miller) a esta curva derivada. Los parámetros $\tau$, $t_o$ y $K$ obtenidos de la curva derivada son entonces los parámetros para el modelo FOPDTI original.

Este enfoque permite transformar el problema de identificar un sistema inestable o integrador en el problema ya conocido y resuelto de identificar un sistema de primer orden más tiempo muerto, facilitando su modelado empírico.

![Ejemplo de curva de reacción de un sistema inestable y su derivada para la aproximación FOPDTI. La gráfica superior muestra la respuesta escalón de un sistema inestable o integrador, donde la salida no se estabiliza. La gráfica inferior muestra la derivada de esta respuesta, que, después de un transitorio, se asemeja a la respuesta de un sistema de primer orden, permitiendo aplicar métodos de identificación conocidos.](images/FOPDTIExample.PNG)

# Ejercicios

### 📚 Ejercicio 1: Cálculo de parámetros con el método de Smith

Un ingeniero mecatrónico realiza una prueba de respuesta escalón a un sistema en lazo abierto y obtiene la siguiente curva de reacción. Se determina que el valor final de la respuesta es 1.5. Utilizando el método de Smith, determine la constante de tiempo ($\tau$), el tiempo muerto ($t_o$) y la ganancia ($K$) del sistema, y exprese la función de transferencia de primer orden más tiempo muerto.
Los puntos de interés obtenidos de la curva son:

* El 28.3% del valor final se alcanza en $t_1 = 1.0$ segundos.
* El 63.2% del valor final se alcanza en $t_2 = 2.0$ segundos.

**Solución:**
Primero, calculamos los valores de amplitud en los puntos P1 y P2:

* $P1 = 1.5 \times 0.283 = 0.4245$
* $P2 = 1.5 \times 0.632 = 0.948$

Las constantes para el método de Smith son: $A=-1.5, B=1.5, C=1.5, D=-0.5$.
Ahora, calculamos $\tau$ y $t_o$:

* $\tau = A \times t_1 + B \times t_2 = (-1.5)(1.0) + (1.5)(2.0) = -1.5 + 3.0 = 1.5$ segundos
* $t_o = C \times t_1 + D \times t_2 = (1.5)(1.0) + (-0.5)(2.0) = 1.5 - 1.0 = 0.5$ segundos

La ganancia $K$ se calcula como el cambio en la salida dividido por el cambio en la entrada. Asumiendo una entrada escalón unitario (cambio de 1):

$$K = \frac{\Delta y}{\Delta u} = \frac{1.5 - 0}{1 - 0} = 1.5$$

Finalmente, la función de transferencia de primer orden más tiempo muerto es:

$$G(s) = \frac{1.5e^{-0.5s}}{1.5s+1}$$

### 📚 Ejercicio 2: Identificación de sistema de segundo orden con Viteckova

Se realiza una prueba de respuesta escalón a un sistema y se observa un valor final de la respuesta de 3. Utilizando el método de Viteckova para identificar un modelo de segundo orden más tiempo muerto, y con los siguientes tiempos obtenidos de la curva de reacción:

* El 33% del valor final se alcanza en $t_1 = 1.81$ segundos.
* El 70% del valor final se alcanza en $t_2 = 3.29$ segundos.

Determine la constante de tiempo ($\tau$), el tiempo muerto ($t_o$) y la ganancia ($K$), y exprese la función de transferencia de segundo orden más tiempo muerto.
**Solución:**
Primero, calculamos los valores de amplitud en los puntos P1 y P2:

* $P1 = 3 \times 0.33 = 0.99$
* $P2 = 3 \times 0.70 = 2.1$

Las constantes para el método de Viteckova son: $A=-0.749, B=0.749, C=1.937, D=-0.937$.
Ahora, calculamos $\tau$ y $t_o$:

* $\tau = A \times t_1 + B \times t_2 = (-0.749)(1.81) + (0.749)(3.29) = -1.3557 + 2.4642 = 1.1085$ segundos
* $t_o = C \times t_1 + D \times t_2 = (1.937)(1.81) + (-0.937)(3.29) = 3.5068 - 3.0827 = 0.4241$ segundos

La ganancia $K$ se calcula de manera similar:

$$K = \frac{\Delta y}{\Delta u} = \frac{3 - 0}{1 - 0} = 3$$

Finalmente, la función de transferencia de segundo orden más tiempo muerto es:

$$G(s) = \frac{3e^{-0.423s}}{(1.1s+1)(1.1s+1)}$$
Desarrollando el denominador:
$$G(s) = \frac{3e^{-0.423s}}{1.21s^2 + 2.2s + 1}$$

## Conclusiones

La identificación de sistemas mediante el análisis de curvas de reacción se consolida como una herramienta invaluable y extremadamente pragmática en el ámbito de la ingeniería de control, siendo un pilar fundamental para la sintonización eficaz y eficiente de controladores, particularmente en los complejos entornos industriales donde la simplicidad operativa, la robustez y la eficiencia en la implementación son factores prioritarios. A lo largo de este informe, hemos desglosado cómo metodologías empíricas, desde los pioneros métodos de Ziegler-Nichols (con su simplicidad y el desafío de la repetibilidad) y el mejorado método de Miller (que aumentó la fiabilidad mediante un enfoque más sistemático), sentaron las bases para la obtención de modelos aproximados de plantas.

La evolución de estas técnicas hacia los más sofisticados métodos de 2 puntos ha marcado un avance significativo. Al utilizar dos puntos de referencia discretos y predefinidos en la curva de reacción, se logra una mayor precisión y consistencia en la representación de la respuesta dinámica del sistema. Esta mejora no solo abarca la identificación de modelos de primer orden con tiempo muerto, sino que también se extiende a la posibilidad de obtener modelos de segundo orden con tiempo muerto, permitiendo así capturar dinámicas más complejas, como las respuestas oscilatorias o de amortiguamiento crítico, que son comunes en muchos procesos industriales.

Es crucial asimilar que los modelos obtenidos de un sistema mediante estas metodologías empíricas son, por naturaleza, aproximaciones y, por lo tanto, poseen una validez inherente restringida a un determinado punto o rango de operación. Dada la prevalencia de la no linealidad en la mayoría de los sistemas industriales, es fundamental entender que las características dinámicas de una planta pueden variar significativamente con las condiciones operativas. Esto implica que, para garantizar un rendimiento de control óptimo en todo el espectro de operación de un proceso, podría ser necesario identificar y utilizar múltiples modelos (o ajustar los parámetros del controlador de forma adaptativa), cada uno optimizado para una región específica de funcionamiento.

Finalmente, hemos resaltado la versatilidad de estas técnicas al considerar su aplicabilidad a sistemas intrínsecamente inestables en lazo abierto. Mediante aproximaciones ingeniosas como la metodología FOPDTI (First-Order Plus Dead Time with Integrator), se demuestra que, incluso para sistemas que no se estabilizan por sí mismos, es posible obtener modelos empíricos que, aunque sean aproximaciones, son suficientemente informativos para el diseño de controladores capaces de estabilizar y regular el proceso.

En síntesis, el dominio de estas técnicas empíricas de identificación por curvas de reacción dota a los ingenieros mecatrónicos de un conjunto de herramientas indispensables para comprender, analizar y, en última instancia, controlar la compleja dinámica de una vasta gama de sistemas. Esta habilidad no solo es una competencia técnica crucial, sino que también representa un pilar fundamental en la formación y práctica profesional, permitiendo abordar los desafíos del control industrial con soluciones prácticas y efectivas.

## Referencias

A continuación, se listan las fuentes bibliográficas y los recursos consultados para la elaboración de este informe, garantizando la rigurosidad y el sustento académico de la información presentada:

* **Alfaro, V.M.** - "Apuntes del curso IE-432 Laboratorio de Control Automático", Escuela e Ingeniería Eléctrica, Universidad de Costa Rica, San José, Costa Rica, 1998. Este documento es una fuente fundamental para la comprensión de los fundamentos de control automático y los métodos de identificación de sistemas empíricos.
* **Nakamura, M.** - *Mecathronic Servosystem Control*. Springer, 1998. Este libro proporciona una base sólida en sistemas de control aplicados a la mecatrónica, incluyendo temas relevantes sobre modelado y control de servomecanismos.
* **J. Rodriguez, J. Cote.** - "Implementation of a Direct Fuzzy Controller Applied to a Helicopter with one Degree of Freedom", *IEEE LATIN AMERICA TRANSACTIONS*, VOL. 17, NO. 11, NOVEMBER 2019. Este artículo científico es un ejemplo de aplicación práctica de técnicas de control en sistemas dinámicos complejos.
* **Material de clase** - "10. Identificación de sistemas.pdf" proporcionado por el profesor. Este documento fue la fuente principal de información y la base para la elaboración de las secciones sobre metodologías de identificación y ejemplos prácticos.
* **Editor de ecuaciones LaTeX:** Se utilizó el editor de ecuaciones en línea de [Alciro.org](http://www.alciro.org/tools/matematicas/editor-ecuaciones.jsp) para la correcta formulación y visualización de las expresiones matemáticas en formato LaTeX dentro del informe.
* **Generador de tablas Markdown:** Para la creación y el formato de las tablas presentadas en este documento, se hizo uso de la herramienta en línea [TablesGenerator.com](https://www.tablesgenerator.com/markdown_tables), que facilita la conversión de datos a la sintaxis de tablas en Markdown.
```
